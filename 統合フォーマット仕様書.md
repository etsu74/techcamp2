# 統合Excelフォーマット仕様書

## 概要
修繕工事イベントと会議イベントを統一管理する19列Excelフォーマット

## ファイル一覧
- `unified_format_template.xlsx` - サンプルデータ入りテンプレート
- `unified_format_empty_template.xlsx` - 入力用空テンプレート

## 19列スキーマ構成

| 列名 | データ型 | 必須 | 説明 | 例 |
|-----|---------|-----|-----|-----|
| id | 文字列 | ◯ | 一意のタスクID | T1, GM1, BM1 |
| name | 文字列 | ◯ | イベント名 | 基本設計, 年次総会 |
| start | 日付 | ◯ | 開始日 (YYYY-MM-DD) | 2025-01-15 |
| end | 日付 | ◯ | 終了日 (YYYY-MM-DD) | 2025-01-31 |
| progress | 数値 | ◯ | 進捗率 (0-100) | 50 |
| dependencies | 文字列 | - | 依存タスクID | T2, BM1 |
| assignee | 文字列 | ◯ | 担当者 | 担当1, 理事長 |
| event_type | 文字列 | ◯ | イベント種別 | construction, meeting |
| organization_level | 数値 | - | 組織レベル (会議のみ) | 1, 2, 3 |
| organization_type | 文字列 | - | 組織種別 (会議のみ) | general_meeting, board_meeting |
| decision_authority | 文字列 | - | 決定権限 (会議のみ) | final, executive, advisory |
| report_to | 文字列 | - | 報告先ID (会議のみ) | GM1 |
| attendees | 文字列 | - | 参加者 (会議のみ) | 全組合員, 理事5名 |
| location | 文字列 | - | 場所 (会議のみ) | 集会所, 管理室 |
| agenda | 文字列 | - | 議題 (会議のみ) | 年度決算承認 |
| timeline_color | 文字列 | - | タイムライン色 | #8B0000, #FF8C00 |
| priority | 文字列 | - | 優先度 | critical, high, medium, low |
| frequency | 文字列 | - | 頻度 (会議のみ) | annual, monthly, adhoc |
| memo | 文字列 | - | メモ | 重要決議事項 |

## イベント種別仕様

### construction (工事イベント)
- **表示**: ガントチャートバー
- **必要列**: id, name, start, end, progress, assignee, event_type
- **オプション列**: dependencies, timeline_color, priority, memo
- **未使用列**: organization_* 系統 (空欄可)

### meeting (会議イベント)
- **表示**: ダイヤモンドマーク (◆)
- **必要列**: id, name, start, end, assignee, event_type
- **会議固有列**: organization_level, organization_type, decision_authority
- **オプション列**: report_to, attendees, location, agenda, timeline_color, priority, frequency, memo

## 組織階層構造

| Level | Type | Authority | 色 | 説明 |
|-------|------|-----------|----|----|
| 1 | general_meeting | final | #8B0000 | 総会 (最高決定機関) |
| 2 | board_meeting | executive | #FF8C00 | 理事会 (執行機関) |
| 3 | repair_committee | advisory | #32CD32 | 修繕委員会 (諮問機関) |

## データ処理フロー

```
統合xlsx入力
    ↓
event_type判定
    ↓
┌─────────────────┬─────────────────┐
│  construction   │    meeting      │
│  (工事イベント)    │  (会議イベント)    │
├─────────────────┼─────────────────┤
│ Frappe Gantt    │ Custom Diamond  │
│ バー表示        │ マーカー表示      │
└─────────────────┴─────────────────┘
```

## 使用方法

1. **テンプレート取得**
   - 空テンプレート: `unified_format_empty_template.xlsx`
   - サンプル: `unified_format_template.xlsx`

2. **データ入力**
   - 工事イベント: event_type = "construction"
   - 会議イベント: event_type = "meeting"

3. **アプリケーション読み込み**
   - ドラッグ&ドロップで統合xlsxファイルを読み込み
   - 自動的に工事バー + 会議ダイヤモンド表示

## 注意事項
- 日付形式: YYYY-MM-DD 形式厳守
- 依存関係: 時系列論理チェック実装済み
- 文字エンコーディング: UTF-8対応
- ファイルサイズ: 制限なし

## バージョン
- 作成日: 2025-08-22
- フォーマットバージョン: v1.0
- 対応システム: Phase-1A-3完成版